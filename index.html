<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BUS 380 AI Lab | Week 7: Root Cause Analysis</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <script>
        const COURSE_PASSWORD = "Evansville";
        let accessGranted = false;
        
        // Simple check before the page fully renders
        let input = prompt("Welcome to BUS 380. Please enter the Course Password to access this lab:");
        
        if (input !== COURSE_PASSWORD) {
            alert("Incorrect password. Access denied.");
            document.write('<div style="height: 100vh; display: flex; flex-direction: column; align-items: center; justify-content: center; font-family: sans-serif; background: #f3f4f6; color: #374151;"><h1>üîí Access Denied</h1><p>Please refresh the page and enter the correct password provided in Blackboard.</p></div>');
            window.stop(); 
        }
    </script>

    <style>
        * { font-family: 'Inter', sans-serif; }
        .lab-container { height: calc(100vh - 60px); }
        .instructions-panel { overflow-y: auto; }
        .instructions-panel::-webkit-scrollbar { width: 6px; }
        .instructions-panel::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
        .task-item.completed { background: #f0fdf4; border-color: #86efac; }
        .task-item.completed .task-text { color: #166534; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        .status-dot { animation: pulse 2s infinite; }
        .ai-btn { transition: all 0.2s; }
        .ai-btn:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.15); }
        .problem-card { transition: all 0.2s; border-width: 2px; }
        .problem-card.selected { border-color: #9333ea; background-color: #faf5ff; }
        
        .gemini-gradient { background: linear-gradient(135deg, #4285F4 0%, #EA4335 25%, #FBBC05 50%, #34A853 75%, #4285F4 100%); }
        .chatgpt-gradient { background: linear-gradient(135deg, #10a37f 0%, #1a7f64 100%); }
        .claude-gradient { background: linear-gradient(135deg, #D97757 0%, #C45A3B 100%); }
        
        @media print { .no-print { display: none !important; } }
    </style>
</head>
<body class="bg-gray-100">
    <header class="bg-white border-b border-gray-200 px-4 py-3 flex items-center justify-between no-print">
        <div class="flex items-center gap-3">
            <div class="bg-purple-600 text-white px-3 py-1 rounded-lg font-semibold text-sm">BUS 380</div>
            <div>
                <h1 class="font-semibold text-gray-800">Week 7 Lab: Root Cause Analysis</h1>
                <p class="text-xs text-gray-500">Generative AI for Business Students</p>
            </div>
        </div>
        <div class="flex items-center gap-4">
            <div class="flex items-center gap-2 text-sm text-gray-600">
                <span class="status-dot w-2 h-2 bg-green-500 rounded-full"></span>
                <span>Lab Active</span>
            </div>
            <div id="progressBadge" class="bg-purple-100 text-purple-700 px-3 py-1 rounded-full text-sm font-medium">
                0/6 Tasks
            </div>
        </div>
    </header>

    <div class="lab-container flex">
        <div class="w-1/2 bg-gray-900 flex flex-col no-print">
            <div class="bg-gray-800 px-4 py-3 border-b border-gray-700">
                <h2 class="text-white font-medium">AI Assistant</h2>
                <p class="text-gray-400 text-xs">Open a tool to begin your work</p>
            </div>
            
            <div class="flex-1 flex flex-col items-center justify-center p-6">
                <div class="grid grid-cols-3 gap-3 w-full max-w-lg">
                    <button onclick="openAI('https://gemini.google.com', 'Gemini')" class="ai-btn bg-gray-800 border border-gray-700 hover:border-blue-500 text-white py-4 px-3 rounded-xl flex flex-col items-center gap-2">
                        <div class="w-10 h-10 gemini-gradient rounded-xl flex items-center justify-center font-bold">G</div>
                        <span class="text-sm">Gemini</span>
                    </button>
                    <button onclick="openAI('https://chat.openai.com', 'ChatGPT')" class="ai-btn bg-gray-800 border border-gray-700 hover:border-green-500 text-white py-4 px-3 rounded-xl flex flex-col items-center gap-2">
                        <div class="w-10 h-10 chatgpt-gradient rounded-xl flex items-center justify-center font-bold">C</div>
                        <span class="text-sm">ChatGPT</span>
                    </button>
                    <button onclick="openAI('https://claude.ai', 'Claude')" class="ai-btn bg-gray-800 border border-gray-700 hover:border-orange-500 text-white py-4 px-3 rounded-xl flex flex-col items-center gap-2">
                        <div class="w-10 h-10 claude-gradient rounded-xl flex items-center justify-center font-bold">A</div>
                        <span class="text-sm">Claude</span>
                    </button>
                </div>
                <div id="currentAI" class="mt-5 hidden">
                    <div class="bg-gray-800 px-4 py-2 rounded-full flex items-center gap-2">
                        <span class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></span>
                        <span class="text-gray-300 text-sm">Using: <span id="currentAIName" class="text-white font-medium">-</span></span>
                    </div>
                </div>
            </div>
        </div>

        <div class="w-1/2 bg-white instructions-panel">
            <div class="border-b border-gray-200 no-print">
                <div class="aspect-video bg-gray-900">
                    <iframe class="w-full h-full" src="https://www.youtube.com/embed/u4ZoJKF_VuA" frameborder="0" allowfullscreen></iframe>
                </div>
            </div>

            <div class="p-6">
                <h2 class="text-xl font-bold text-gray-800 mb-4">üß™ Lab: The 3 Whys Investigation</h2>
                
                <div class="space-y-4">
                    <div class="task-item border border-gray-200 rounded-lg p-4" id="task1">
                        <h4 class="font-medium text-gray-800">Step 1: Choose a Business Problem</h4>
                        <div class="grid grid-cols-1 gap-2 mt-3">
                            <div class="problem-card border border-gray-200 rounded-lg p-3 cursor-pointer" onclick="selectProblem(this, 'E-Commerce: Shopping cart abandonment rate is 75%')">
                                <p class="text-sm">üõí E-Commerce: Cart abandonment is at 75%</p>
                            </div>
                            <div class="problem-card border border-gray-200 rounded-lg p-3 cursor-pointer" onclick="selectProblem(this, 'Operations: Employees spend 60% of their time in meetings')">
                                <p class="text-sm">‚öôÔ∏è Operations: Excessive meeting culture</p>
                            </div>
                        </div>
                        <input type="hidden" id="problemChoice" value="">
                    </div>

                    <div class="task-item border border-gray-200 rounded-lg p-4" id="task2">
                        <h4 class="font-medium text-gray-800">Step 2: Research the Problem</h4>
                        <div class="bg-gray-100 p-3 rounded mt-2 text-sm font-mono relative">
                            <button onclick="copyPrompt('prompt1', this)" class="absolute top-2 right-2 bg-purple-600 text-white px-2 py-1 rounded text-xs">Copy</button>
                            <span id="prompt1">What are the 3 most common reasons for [YOUR PROBLEM]? Provide industry benchmarks.</span>
                        </div>
                        <textarea id="researchInsights" onchange="saveAnswer('researchInsights', this.value)" rows="2" class="w-full mt-3 px-3 py-2 border rounded-lg text-sm" placeholder="Paste AI insights here..."></textarea>
                    </div>

                    <div class="task-item border border-gray-200 rounded-lg p-4" id="task3">
                        <h4 class="font-medium text-gray-800">Step 3: The 3 Whys Analysis</h4>
                        <div class="bg-gray-100 p-3 rounded mt-2 text-sm font-mono relative">
                            <button onclick="copyPrompt('prompt2', this)" class="absolute top-2 right-2 bg-purple-600 text-white px-2 py-1 rounded text-xs">Copy</button>
                            <span id="prompt2">Let's do a '3 Whys' analysis for: [YOUR PROBLEM]. Ask me 'Why?' three times to find the root cause. Start with Why #1.</span>
                        </div>
                        <div class="space-y-2 mt-4">
                            <input type="text" id="why1" onchange="saveAnswer('why1', this.value)" class="w-full px-3 py-2 border rounded-lg text-sm" placeholder="Why #1 answer...">
                            <input type="text" id="why2" onchange="saveAnswer('why2', this.value)" class="w-full px-3 py-2 border rounded-lg text-sm" placeholder="Why #2 answer...">
                            <input type="text" id="why3" onchange="saveAnswer('why3', this.value)" class="w-full px-3 py-2 border rounded-lg text-sm" placeholder="Why #3 answer (The Root Cause)...">
                        </div>
                    </div>

                    <div class="task-item border border-gray-200 rounded-lg p-4" id="task4">
                        <h4 class="font-medium text-gray-800">Step 4: Identify the Final Root Cause</h4>
                        <textarea id="rootCause" onchange="saveAnswer('rootCause', this.value)" rows="2" class="w-full mt-2 px-3 py-2 border-2 border-green-200 rounded-lg text-sm" placeholder="State the final actionable root cause..."></textarea>
                    </div>

                    <div class="task-item border border-gray-200 rounded-lg p-4" id="task5">
                        <h4 class="font-medium text-gray-800">Step 5: Reflection</h4>
                        <textarea id="reflection" onchange="saveAnswer('reflection', this.value)" rows="2" class="w-full mt-2 px-3 py-2 border rounded-lg text-sm" placeholder="How did the AI help you dig deeper than usual?"></textarea>
                    </div>
                </div>

                <div class="mt-8 bg-purple-600 rounded-lg p-6 text-white text-center">
                    <h3 class="font-bold text-lg mb-2">üì• Ready to Finish?</h3>
                    <button onclick="downloadLabReport()" class="w-full bg-white text-purple-600 py-3 rounded-lg font-bold hover:bg-purple-50 transition">
                        Download Lab Report (.txt)
                    </button>
                    <p class="text-xs text-purple-200 mt-2">Upload this file to Blackboard for grading.</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        let answers = {};
        let selectedAI = "";

        function selectProblem(element, text) {
            document.querySelectorAll('.problem-card').forEach(c => c.classList.remove('selected', 'bg-purple-50'));
            element.classList.add('selected', 'bg-purple-50');
            document.getElementById('problemChoice').value = text;
            saveAnswer('problemChoice', text);
            document.getElementById('task1').classList.add('completed');
        }

        function openAI(url, name) {
            window.open(url, '_blank');
            selectedAI = name;
            document.getElementById('currentAI').classList.remove('hidden');
            document.getElementById('currentAIName').textContent = name;
        }

        function saveAnswer(key, val) {
            answers[key] = val;
            updateProgress();
        }

        function updateProgress() {
            const count = Object.keys(answers).filter(k => answers[k].length > 0).length;
            document.getElementById('progressBadge').textContent = `${count}/5 Progress`;
        }

        function copyPrompt(id, btn) {
            const problem = document.getElementById('problemChoice').value || "my business problem";
            const text = document.getElementById(id).textContent.replace('[YOUR PROBLEM]', problem);
            navigator.clipboard.writeText(text);
            btn.textContent = "Copied!";
            setTimeout(() => btn.textContent = "Copy", 2000);
        }

        function downloadLabReport() {
            if (!answers.problemChoice || !answers.rootCause) {
                alert("Please select a problem and identify a root cause before downloading.");
                return;
            }
            const report = `
BUS 380: AI LAB REPORT - ROOT CAUSE ANALYSIS
---------------------------------------------
Date: ${new Date().toLocaleString()}
AI Tool Used: ${selectedAI || 'Not Specified'}

SELECTED PROBLEM:
${answers.problemChoice}

RESEARCH INSIGHTS:
${answers.researchInsights || 'None provided'}

THE 3 WHYS:
1. ${answers.why1 || 'N/A'}
2. ${answers.why2 || 'N/A'}
3. ${answers.why3 || 'N/A'}

FINAL ROOT CAUSE:
${answers.rootCause}

STUDENT REFLECTION:
${answers.reflection || 'None provided'}
---------------------------------------------
University of Evansville | Spring 2026
            `;
            const blob = new Blob([report], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `BUS380_Lab_Report.txt`;
            a.click();
        }
    </script>
</body>
</html>
